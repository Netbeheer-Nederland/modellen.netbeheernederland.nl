<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Redirecting...</title>
    <script>
        var newHostname = "netbeheer-nederland.github.io";
        
        if (window.location.hostname !== newHostname) {
            
            var storageKey = 'redirect_attempts_' + newHostname;
            
            // Haal het aantal pogingen op (standaard 0 als het niet bestaat)
            var attempts = parseInt(sessionStorage.getItem(storageKey) || "0");
            
            var url = new URL(window.location.href);
            url.hostname = newHostname;
            url.protocol = "https:";

            // --- FASE 1: Eerste poging (Clean redirect) ---
            if (attempts === 0) {
                // Zet teller op 1 en probeer het
                sessionStorage.setItem(storageKey, "1");
                window.location.replace(url.href);
            } 
            
            // --- FASE 2: Tweede poging (Cache Buster) ---
            else if (attempts === 1) {
                // We zijn teruggekomen na poging 1. Blijkbaar zat er een loop of cache probleem.
                // Zet teller op 2.
                sessionStorage.setItem(storageKey, "2");
                
                // Voeg de cache buster toe
                url.searchParams.set('cb', Date.now());
                
                console.warn("Eerste redirect mislukt, poging met cache-buster...");
                window.location.replace(url.href);
            }
            
            // --- FASE 3: Opgeven (Foutmelding tonen) ---
            else {
                // We zijn teruggekomen na poging 2. Zelfs de cache buster werkte niet (of de server stuurt terug).
                console.error("Redirect loop gedetecteerd. Script stopt.");
                
                // Voor de zekerheid maken we voor de link NOG een nieuwe timestamp
                url.searchParams.set('cb', Date.now());

                window.onload = function() {
                    document.body.innerHTML = 
                        '<div style="font-family: sans-serif; max-width: 600px; margin: 2rem auto; line-height: 1.6;">' +
                        '<h1>Automatic Redirection Interrupted</h1>' +
                        '<p>Your browser is retaining outdated cache information, which is causing a redirection loop.</p>' +
                        '<p><strong><a href="' + url.href + '">Click here to force a reload to the new website &rarr;</a></strong></p>' +
                        '<hr style="margin: 20px 0; border: 0; border-top: 1px solid #ccc;">' +
                        '<p style="font-size: 0.9em; color: #555;">To resolve this issue permanently for the original link:</p>' +
                        '<ul style="font-size: 0.9em; color: #555;">' +
                            '<li><strong>Chrome Users:</strong> Copy and paste <code>chrome://settings/clearBrowserData</code> into your address bar and clear "Cached images and files".</li>' +
                            '<li><strong>Alternative:</strong> Open the site in Incognito Mode (Private Browsing).</li>' +
                        '</ul>' +
                        '</div>';
                };
            }
        }
    </script>
</head>
<body>
    <p>Redirecting...</p>
</body>
</html>